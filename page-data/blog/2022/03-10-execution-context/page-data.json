{"componentChunkName":"component---src-templates-{post}-tsx-content-file-path-null","path":"/blog/2022/03-10-execution-context/","result":{"data":{"markdownRemark":{"html":"<h2>요약</h2>\n<p><strong>실행 컨텍스트</strong>란 소스코드를 실행하는 데 필요한 환경을 제공하고 코드의 실행 결과를 관리하는 영역입니다.</p>\n<p>코드의 실행 순서는 <strong>실행 컨텍스트 스택</strong>에 의해, 스코프와 식별자는 실행 컨텍스트의 <strong>렉시컬 환경</strong>에 의해 관리됩니다.</p>\n<h2>소스코드의 평가와 실행</h2>\n<p>자바스크립트 엔진은 소스코드를 2개의 과정으로 나누어 처리합니다.</p>\n<ul>\n<li><strong>소스코드의 평가</strong>\n<ul>\n<li>함수와 변수의 선언문을 실행</li>\n<li>생성된 함수와 변수 식별자를 실행 컨텍스트가 관리하는 스코프에 등록</li>\n<li>평가 과정이 끝나야 소스코드가 실행됨</li>\n</ul>\n</li>\n<li><strong>소스코드의 실행</strong>\n<ul>\n<li>선언문을 제외한 소스코드를 실행</li>\n<li>소스코드의 실행에 필요한 정보를 실행 컨텍스트가 관리하는 스코프에서 취득</li>\n<li>실행한 결과를 다시 스코프에 반영</li>\n</ul>\n</li>\n</ul>\n<p>코드가 실행되려면 스코프와 식별자의 관리와 코드 실행 순서의 관리가 필요한데, 스코프와 식별자는 <strong>렉시컬 환경</strong>으로, 코드의 실행 순서는 <strong>실행 컨텍스트 스택</strong>으로 관리하게 됩니다.</p>\n<h2>실행 컨텍스트 스택</h2>\n<p>코드를 통해 생성된 실행 컨텍스트는 스택으로 관리됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> b <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 15</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f5008f24d4d9a1d45f61a338c56a210/20a35/execution-context-stack.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVR42oWOy0oDQRBF53N17cKtICE/oqvoKkZB/AARAuILcSNIIBCDds/0I0lX97Gmx61Ym3u51H00/HHlF7cJjmdwNAXJ/HtNNZeCiCgOot8IBxMYX0FQfjYvTOYQt8L4snB4DsanWttbBu9gbnLuSWbxGdk/LYxmGesi03vh5iUTQmT5vWNlpfLrp8TFQ6Z1QcOFvZPCYr3RiB19VmOMIcagSxK3r4bnD0/SRtdaDXD6lFmtDV/G1SVdp7rvKn9877h7a+ty7xzWWn4Ah90uqNB5sg0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f5008f24d4d9a1d45f61a338c56a210/89b46/execution-context-stack.webp 180w,\n/static/5f5008f24d4d9a1d45f61a338c56a210/97ead/execution-context-stack.webp 360w,\n/static/5f5008f24d4d9a1d45f61a338c56a210/fb07f/execution-context-stack.webp 720w,\n/static/5f5008f24d4d9a1d45f61a338c56a210/e1ffd/execution-context-stack.webp 1016w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f5008f24d4d9a1d45f61a338c56a210/96042/execution-context-stack.png 180w,\n/static/5f5008f24d4d9a1d45f61a338c56a210/7a322/execution-context-stack.png 360w,\n/static/5f5008f24d4d9a1d45f61a338c56a210/16546/execution-context-stack.png 720w,\n/static/5f5008f24d4d9a1d45f61a338c56a210/20a35/execution-context-stack.png 1016w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f5008f24d4d9a1d45f61a338c56a210/16546/execution-context-stack.png\"\n            alt=\"execution-context-stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol>\n<li>프로그램이 실행되고 전역 코드가 평가되면 전역 실행 컨텍스트가 생성되어 실행 컨텍스트 스택에 추가됩니다. 이때 <code>a</code>, <code>foo</code>의 선언문이 실행되어 전역 실행 컨텍스트에 등록됩니다. 이후 전역 코드가 실행되고 <code>foo</code> 함수를 호출합니다.</li>\n<li><code>foo</code> 함수가 호출되면 전역 코드의 실행은 일시 중단되고 제어권이 <code>foo</code> 함수로 넘어갑니다. 그리고 <code>foo</code> 함수를 평가하여 실행 컨텍스트를 생성하고 스택에 추가합니다. <code>foo</code> 내의 변수 <code>b</code>와 함수 <code>bar</code>는 <code>foo</code> 함수의 실행 컨텍스트에 등록됩니다. 이후 <code>foo</code> 함수를 실행하고 <code>bar</code> 함수를 호출합니다.</li>\n<li><code>bar</code> 함수가 호출되면 마찬가지로 제어권이 <code>bar</code> 함수로 넘어갑니다. <code>bar</code> 함수의 실행 컨텍스트가 생성되어 스택에 추가되고, 이후 함수를 실행합니다. <code>console.log</code>가 호출되면 우선 스코프 체이닝을 통해 <code>console</code> 식별자를 찾고, 이후 <code>console</code> 객체에서 프로토타입 체이닝을 통해 <code>log</code> 식별자를 찾아 호출합니다. 그리고 함수의 인수로 전달된 <code>a</code>와 <code>b</code> 역시 스코프 체이닝을 통해 검색합니다.</li>\n<li><code>bar</code>의 실행이 끝나면 다시 제어권이 <code>foo</code> 함수로 넘어오고, 실행이 끝난 <code>bar</code> 함수는 실행 컨텍스트 스택에서 제거됩니다.</li>\n<li>이후 <code>foo</code>의 실행이 끝나 실행 컨텍스트 스택에서 제거되고, 제어권은 전역 코드로 넘어옵니다. 곧이어 전역 코드의 실행이 마저 끝나면 전역 실행 컨텍스트도 스택에서 제거됩니다.</li>\n</ol>\n<h2>렉시컬 환경</h2>\n<p><b>렉시컬 환경(Lexical Environment)</b>은 코드의 실행에 있어 식별자와 스코프를 관리하는 역할을 합니다. 렉시컬 환경은 두 개의 컴포넌트로 구성됩니다.</p>\n<ul>\n<li><strong>Environment Record</strong>: 스코프에 포함된 식별자를 등록하고 해당 식별자에 바인딩된 값을 관리하는 저장소입니다. 전역 코드냐 함수 코드냐에 따라 구성에 차이가 있습니다.\n<ul>\n<li>전역 환경\n<ul>\n<li><strong>Object Environment Record</strong>: BindingObject라는 전역 객체와 연결됩니다. 전역 코드 평가 중 <code>var</code>로 선언한 변수와 함수 선언문으로 정의된 함수는 이 BindingObject를 통해 전역 객체의 프로퍼티와 메서드가 됩니다. 이때 프로퍼티는 암묵적으로 <code>undefined</code>를 할당하고, 메서드는 생성된 함수 객체를 즉시 할당합니다. 이 때문에 호이스팅이 발생합니다.</li>\n<li><strong>Declarative Environment Record</strong>: <code>let</code>, <code>const</code>로 선언한 전역 변수를 등록하고 관리합니다. 따라서 이들은 전역 객체의 프로퍼티가 되지 않습니다. 또한 <code>var</code> 변수와 달리 값을 초기화하지 않으므로 런타임에 실행 흐름이 변수 선언에 도달하기 전까지 일시적 사각지대(TDZ)에 빠지게 됩니다.</li>\n<li><strong>this Binding</strong>: 전역 객체를 바인딩합니다.</li>\n</ul>\n</li>\n<li>함수 환경\n<ul>\n<li><strong>Function Environment Record</strong>: 매개변수 및 함수 내부에서 선언된 변수와 함수를 등록하고 관리합니다.</li>\n<li><strong>this Binding</strong>: 함수 호출 방식에 따라 this 바인딩이 결정됩니다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>Outer Lexical Environment Reference</strong>: 상위 스코프(해당 실행 컨텍스트를 생성한 소스코드를 포함하는 상위 코드의 렉시컬 환경)을 가리킵니다. 이를 통해 스코프 체인을 구현합니다.\n<ul>\n<li>전역 환경: 전역 코드를 포함하는 소스코드는 없으므로 null이 할당됩니다.</li>\n<li>함수 환경: 현재 이 함수를 평가하는 실행 컨텍스트의 렉시컬 환경의 참조가 할당됩니다.</li>\n</ul>\n</li>\n</ul>\n<h3>블록 레벨 스코프</h3>\n<p><code>let</code>과 <code>const</code>로 선언한 변수는 블록 레벨 스코프를 따릅니다. 때문에 블럭 내에서 <code>let</code>이나 <code>const</code>로 변수가 선언될 경우 새로운 렉시컬 환경을 생성하여 교체합니다. 블록 렉시컬 환경의 Outer Lexical Environment Reference는 블록에 진입하기 전의 렉시컬 환경을 가리키며, 블록의 실행이 끝나면 다시 기존의 렉시컬 환경으로 되돌립니다.</p>\n<h2>참고 자료</h2>\n<ul>\n<li>이웅모, 『모던 자바스크립트 Deep Dive』</li>\n</ul>","frontmatter":{"title":"실행 컨텍스트(Execution Context)","date":"2022-03-10","tags":["JavaScript"],"thumbnail":null},"timeToRead":2}},"pageContext":{"id":"d7fb10b1-e450-56c5-9f6c-2668c5b14ab9"}},"staticQueryHashes":["1147043159"],"slicesMap":{}}