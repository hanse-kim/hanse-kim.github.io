<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.7"/><meta property="og:locale" content="ko_KR" data-gatsby-head="true"/><meta property="og:site_name" content="hanse-kim.dev" data-gatsby-head="true"/><meta property="og:type" content="article" data-gatsby-head="true"/><meta property="og:title" content="Gatsby 블로그 제작 - 검색 기능 구현 | hanse-kim.dev" data-gatsby-head="true"/><meta property="og:description" content="개발 과정에서 겪은 문제와 그것을 어떻게 해결했는지를 기록하기 위한 블로그입니다." data-gatsby-head="true"/><meta property="og:url" content="https://hanse-kim.github.io/2022/02-18-gatsby-blog-search/" data-gatsby-head="true"/><style data-href="/styles.4464af729e8ddfbbb55d.css" data-identity="gatsby-global-css">/*
! tailwindcss v3.4.10 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{-webkit-text-size-adjust:100%;font-feature-settings:normal;-webkit-tap-highlight-color:transparent;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:normal;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}@font-face{font-named-instance:"Regular";font-display:swap;font-family:Pretendard;font-style:normal;font-weight:100 900;src:url(/fonts/PretendardVariable.woff2) format("woff2")}*{font-family:Pretendard,sans-serif}html{--tw-bg-opacity:1;background-color:hsl(var(--twc-bg)/var(--twc-bg-opacity,var(--tw-bg-opacity)));font-size:16px}html[data-transition=true],html[data-transition=true] *{transition-duration:.15s!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important}hr{--tw-border-opacity:1;border-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-border-opacity)))}@media (max-width:1080px){html{font-size:14px}}@media (max-width:640px){html{font-size:12px}}@property --angle{syntax:"<angle>";initial-value:0deg;inherits:false}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0}.-bottom-2{bottom:-.125rem}.left-0{left:0}.left-1\/2{left:50%}.right-0{right:0}.top-0{top:0}.top-1\/2{top:50%}.z-10{z-index:10}.mx-auto{margin-left:auto;margin-right:auto}.-mb-24{margin-bottom:-1.5rem}.-mt-24{margin-top:-1.5rem}.mb-18{margin-bottom:1.125rem}.mb-24{margin-bottom:1.5rem}.mb-36{margin-bottom:2.25rem}.ml-24{margin-left:1.5rem}.mt-12{margin-top:.75rem}.mt-16{margin-top:1rem}.mt-36{margin-top:2.25rem}.mt-48{margin-top:3rem}.mt-8{margin-top:.5rem}.line-clamp-2{-webkit-box-orient:vertical;-webkit-line-clamp:2;display:-webkit-box;overflow:hidden}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-2{height:.125rem}.h-36{height:2.25rem}.h-\[24px\]{height:24px}.h-footer-height{height:6.75rem}.h-full{height:100%}.h-header-height{height:4.5rem}.min-h-\[100vh\]{min-height:100vh}.w-36{width:2.25rem}.w-\[24px\]{width:24px}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.max-w-screen-width{max-width:67.5rem}.flex-shrink-0{flex-shrink:0}.-translate-x-1\/2{--tw-translate-x:-50%}.-translate-x-1\/2,.-translate-y-1\/2{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y:-50%}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.cursor-pointer{cursor:pointer}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.gap-12{gap:.75rem}.gap-18{gap:1.125rem}.gap-20{gap:1.25rem}.gap-24{gap:1.5rem}.gap-4{gap:.25rem}.gap-x-20{-moz-column-gap:1.25rem;column-gap:1.25rem}.gap-y-32{row-gap:2rem}.overflow-hidden{overflow:hidden}.break-all{word-break:break-all}.rounded-16{border-radius:16px}.rounded-4{border-radius:4px}.rounded-8{border-radius:8px}.rounded-full{border-radius:9999px}.border-1{border-width:1px}.border-b-1{border-bottom-width:1px}.border-solid{border-style:solid}.border-border{--tw-border-opacity:1;border-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-border-opacity)))}.bg-bg{--tw-bg-opacity:1;background-color:hsl(var(--twc-bg)/var(--twc-bg-opacity,var(--tw-bg-opacity)))}.bg-bg-footer{--tw-bg-opacity:1;background-color:hsl(var(--twc-bg-footer)/var(--twc-bg-footer-opacity,var(--tw-bg-opacity)))}.bg-border{--tw-bg-opacity:1;background-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-bg-opacity)))}.bg-main{--tw-bg-opacity:1;background-color:hsl(var(--twc-main)/var(--twc-main-opacity,var(--tw-bg-opacity)))}.object-cover{-o-object-fit:cover;object-fit:cover}.p-24{padding:1.5rem}.px-20{padding-left:1.25rem;padding-right:1.25rem}.px-24{padding-left:1.5rem;padding-right:1.5rem}.px-32{padding-left:2rem;padding-right:2rem}.px-8{padding-left:.5rem;padding-right:.5rem}.py-32{padding-bottom:2rem;padding-top:2rem}.pb-16{padding-bottom:1rem}.pb-4{padding-bottom:.25rem}.pb-48{padding-bottom:3rem}.pl-24{padding-left:1.5rem}.pt-3{padding-top:.1875rem}.text-14-400{font-size:.875rem;font-weight:400}.text-16-300{font-size:1rem;font-weight:300}.text-16-400{font-size:1rem;font-weight:400}.text-18-300{font-size:1.125rem;font-weight:300}.text-18-400{font-size:1.125rem;font-weight:400}.text-20-400{font-size:1.25rem;font-weight:400}.text-24-400{font-size:1.5rem;font-weight:400}.text-24-800{font-size:1.5rem;font-weight:800}.text-32-700{font-size:2rem;font-weight:700}.text-36-700{font-size:2.25rem;font-weight:700}.text-96-700{font-size:6rem;font-weight:700}.text-main{--tw-text-opacity:1;color:hsl(var(--twc-main)/var(--twc-main-opacity,var(--tw-text-opacity)))}.text-text-footer{--tw-text-opacity:1;color:hsl(var(--twc-text-footer)/var(--twc-text-footer-opacity,var(--tw-text-opacity)))}.text-text-quote{--tw-text-opacity:1;color:hsl(var(--twc-text-quote)/var(--twc-text-quote-opacity,var(--tw-text-opacity)))}.underline{text-decoration-line:underline}.underline-offset-\[0\.2em\]{text-underline-offset:.2em}.opacity-0{opacity:0}.opacity-100{opacity:1}.outline{outline-style:solid}.outline-1{outline-width:1px}.outline-transparent{outline-color:transparent}.drop-shadow-transparent{--tw-drop-shadow:drop-shadow(0 0 0px transparent);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-opacity{transition-duration:.15s;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-shadow{transition-duration:.15s;transition-property:box-shadow,filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-75{transition-duration:75ms}.light,[data-theme=light]{--twc-main:207.5 100% 42.7%;--twc-text:205.70000000000005 11.9% 11.6%;--twc-text-footer:204.70000000000005 11.9% 28%;--twc-text-quote:206.70000000000005 12% 44.1%;--twc-bg:0 0% 100%;--twc-blur:210 10% 96.1%;--twc-bg-footer:210 10% 96.1%;--twc-border:210 8.7% 91%}.dark,[data-theme=dark]{--twc-main:207.5 81.9% 54.5%;--twc-text:205.70000000000005 28% 95.1%;--twc-text-footer:204.5 23.9% 82%;--twc-text-quote:205.70000000000005 24.5% 72%;--twc-bg:205.70000000000005 11.9% 11.6%;--twc-blur:210 28.9% 17.6%;--twc-bg-footer:210 28.9% 17.6%;--twc-border:210 22.4% 22.7%}html *{--tw-text-opacity:1;color:hsl(var(--twc-text)/var(--twc-text-opacity,var(--tw-text-opacity)))}.after\:block:after{content:var(--tw-content);display:block}.after\:h-\[1px\]:after{content:var(--tw-content);height:1px}.after\:w-full:after{content:var(--tw-content);width:100%}.after\:scale-x-0:after{--tw-scale-x:0;content:var(--tw-content);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.after\:bg-text:after{--tw-bg-opacity:1;background-color:hsl(var(--twc-text)/var(--twc-text-opacity,var(--tw-bg-opacity)));content:var(--tw-content)}.after\:transition-transform:after{content:var(--tw-content);transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.disabled\:cursor-default:disabled{cursor:default}.data-\[loaded\=false\]\:pointer-events-none[data-loaded=false]{pointer-events:none}.data-\[loaded\=false\]\:absolute[data-loaded=false]{position:absolute}.data-\[active\=true\]\:text-text[data-active=true]{--tw-text-opacity:1;color:hsl(var(--twc-text)/var(--twc-text-opacity,var(--tw-text-opacity)))}.data-\[in\=true\]\:opacity-100[data-in=true]{opacity:1}.data-\[loaded\=false\]\:opacity-0[data-loaded=false]{opacity:0}.data-\[active\=true\]\:drop-shadow-text[data-active=true]{--tw-drop-shadow:drop-shadow(0 0 0.5px currentColor);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.after\:data-\[active\=true\]\:scale-x-100[data-active=true]:after{--tw-scale-x:1;content:var(--tw-content);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes dark-mode-icon-out{0%{opacity:1;transform:scale(1) rotate(0deg)}to{opacity:0;transform:scale(0) rotate(-1turn)}}.group[data-animating=true] .group-data-\[animating\=true\]\:data-\[in\=false\]\:animate-dark-mode-icon-out[data-in=false]{animation:dark-mode-icon-out .25s ease-in forwards}@keyframes dark-mode-icon-in{0%{opacity:0;transform:scale(0) rotate(1turn)}to{opacity:1;transform:scale(1) rotate(0deg)}}.group[data-animating=true] .group-data-\[animating\=true\]\:data-\[in\=true\]\:animate-dark-mode-icon-in[data-in=true]{animation:dark-mode-icon-in .25s ease-in forwards}.peer[data-loaded=true]~.peer-data-\[loaded\=true\]\:hidden{display:none}@media (min-width:1081px){@media (min-width:1081px){.desktop\:desktop\:hover\:bg-blur:hover{--tw-bg-opacity:1;background-color:hsl(var(--twc-blur)/var(--twc-blur-opacity,var(--tw-bg-opacity)))}}.desktop\:hover\:bg-main:hover{--tw-bg-opacity:1;background-color:hsl(var(--twc-main)/var(--twc-main-opacity,var(--tw-bg-opacity)))}.desktop\:hover\:text-bg:hover{--tw-text-opacity:1;color:hsl(var(--twc-bg)/var(--twc-bg-opacity,var(--tw-text-opacity)))}.desktop\:hover\:text-text:hover{--tw-text-opacity:1;color:hsl(var(--twc-text)/var(--twc-text-opacity,var(--tw-text-opacity)))}.desktop\:hover\:outline-blur:hover{outline-color:hsl(var(--twc-blur)/var(--twc-blur-opacity,1))}.desktop\:hover\:drop-shadow-post:hover{--tw-drop-shadow:drop-shadow(0 0 2px currentColor)}.desktop\:hover\:drop-shadow-post:hover,.desktop\:hover\:drop-shadow-text:hover{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.desktop\:hover\:drop-shadow-text:hover{--tw-drop-shadow:drop-shadow(0 0 0.5px currentColor)}.desktop\:hover\:after\:scale-x-100:hover:after{--tw-scale-x:1;content:var(--tw-content);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.desktop\:active\:bg-border:active{--tw-bg-opacity:1;background-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-bg-opacity)))}}@media (max-width:1080px){.tablet\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.tablet\:outline-border{outline-color:hsl(var(--twc-border)/var(--twc-border-opacity,1))}}@media (max-width:640px){.mobile\:flex{display:flex}.mobile\:hidden{display:none}.mobile\:flex-col{flex-direction:column}.mobile\:items-stretch{align-items:stretch}}.\[\&\>svg\]\:text-text>svg{--tw-text-opacity:1;color:hsl(var(--twc-text)/var(--twc-text-opacity,var(--tw-text-opacity)))}.md div:empty,.md p:empty{display:none}.md h1,.md h2{--tw-border-opacity:1;border-bottom-width:1px;border-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-border-opacity)));border-style:solid;margin-top:.5em}.md h1{font-size:2.25rem}.md h1,.md h2{font-weight:700}.md h2{font-size:1.875rem}.md h3{font-size:1.5rem}.md h3,.md h4{font-weight:700}.md h4{font-size:1.25rem}.md ol,.md ul{padding-left:2rem}.md ol{list-style-type:decimal}.md ul{list-style-type:disc}.md li:not(:first-of-type){margin-top:.875rem}.md blockquote{--tw-border-opacity:1;border-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-border-opacity)));border-left-color:hsl(var(--twc-main)/var(--twc-main-opacity,var(--tw-border-opacity)));border-style:dashed dashed dashed solid;border-width:1px 1px 1px 4px;display:flex;flex-direction:column;gap:.875rem;padding:1rem}.md blockquote,.md blockquote *{--tw-text-opacity:1;color:hsl(var(--twc-text-quote)/var(--twc-text-quote-opacity,var(--tw-text-opacity)))}.md a{--tw-text-opacity:1;color:hsl(var(--twc-main)/var(--twc-main-opacity,var(--tw-text-opacity)));display:inline-block;text-decoration-line:underline}.md a:after{--tw-content:"🔗";content:var(--tw-content);font-size:.9em}.md a:visited{color:#9370db}.md img{display:block;margin:0 auto}.md table{border-collapse:collapse;border-radius:2px;overflow:hidden}.md td,.md th{--tw-border-opacity:1;border-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-border-opacity)));border-style:solid;border-width:1px;padding:.25rem .5rem}.md th{--tw-bg-opacity:1;background-color:hsl(var(--twc-bg-footer)/var(--twc-bg-footer-opacity,var(--tw-bg-opacity)))}.md tr:nth-child(2n){--tw-bg-opacity:0.4;background-color:hsl(var(--twc-blur)/var(--twc-blur-opacity,var(--tw-bg-opacity)))}.md code:not([class*=language-]){--tw-border-opacity:1;--tw-bg-opacity:1;--tw-text-opacity:1;background-color:hsl(var(--twc-bg-footer)/var(--twc-bg-footer-opacity,var(--tw-bg-opacity)));border-color:hsl(var(--twc-border)/var(--twc-border-opacity,var(--tw-border-opacity)));border-radius:4px;border-style:solid;border-width:1px;color:hsl(var(--twc-main)/var(--twc-main-opacity,var(--tw-text-opacity)));margin-left:.125rem;margin-right:.125rem;padding-left:.25rem;padding-right:.25rem;width:-moz-fit-content;width:fit-content}.md code,.md code *{font-family:Consolas,Monaco,monospace;font-size:1.125rem;font-weight:400}.md .caption{--tw-translate-y:-0.6rem;--tw-text-opacity:1;color:hsl(var(--twc-text-footer)/var(--twc-text-footer-opacity,var(--tw-text-opacity)));display:flex;font-style:italic;justify-content:center;margin-bottom:-1rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));white-space:pre-wrap;width:100%}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ELYB3E19X0"></script><script>
    window.GATSBY_GTAG_PLUGIN_GA_TRACKING_ID = (
      'G-ELYB3E19X0'
    );
    window.GATSBY_GTAG_PLUGIN_ANONYMIZE = false;

    var options = {
      send_page_view: false
    };
    if (false) {
      options.anonymize_ip = true;
    }

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gtag = gtag;
    gtag('js', new Date());
    gtag('config', 'G-ELYB3E19X0', options);
  </script><link rel="icon" href="/favicon-32x32.png?v=25771371f1974bf11de79dfe5c6f9c53" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=25771371f1974bf11de79dfe5c6f9c53"/><link rel="preload" href="/fonts/PretendardVariable.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><title data-gatsby-head="true">Gatsby 블로그 제작 - 검색 기능 구현 | hanse-kim.dev</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><article><header><div class="ml-24 -mb-24 mt-36 w-fit"><button class="cursor-pointer w-fit text-18-300-footer drop-shadow-transparent transition-shadow disabled:cursor-default desktop:hover:drop-shadow-text desktop:hover:text-text data-[active=true]:drop-shadow-text data-[active=true]:text-text after:block after:w-full after:h-[1px] after:bg-text after:scale-x-0 desktop:hover:after:scale-x-100 after:transition-transform after:data-[active=true]:scale-x-100">&lt; 이전 페이지로</button></div><h1 class="px-24 mt-48 mb-24 text-36-700">Gatsby 블로그 제작 - 검색 기능 구현</h1><div class="pl-24 -mt-24 mb-36"><div class="text-18-400 text-text-footer">2022-02-18 · 6 min read</div><div class="flex gap-12 mt-12"><div><button class="px-8 pt-3 pb-4 transition-colors rounded-4 bg-border text-main text-14-400 desktop:hover:text-bg desktop:hover:bg-main">Gatsby</button></div><div><button class="px-8 pt-3 pb-4 transition-colors rounded-4 bg-border text-main text-14-400 desktop:hover:text-bg desktop:hover:bg-main">GraphQL</button></div></div></div></header><style>
  /*
 Solarized Color Schemes originally by Ethan Schoonover
 http://ethanschoonover.com/solarized

 Ported for PrismJS by Hector Matos
 Website: https://krakendev.io
 Twitter Handle: https://twitter.com/allonsykraken)
*/

  /*
SOLARIZED HEX
--------- -------
base03    #002b36
base02    #073642
base01    #586e75
base00    #657b83
base0     #839496
base1     #93a1a1
base2     #eee8d5
base3     #fdf6e3
yellow    #b58900
orange    #cb4b16
red       #dc322f
magenta   #d33682
violet    #6c71c4
blue      #268bd2
cyan      #2aa198
green     #859900
*/

pre[class*=&#x27;language-&#x27;] {
  --base03: #002b36;
  --base02: #073642;
  --base01: #586e75;
  --base00: #657b83;
  --base0: #839496;
  --base1: #93a1a1;
  --base2: #eee8d5;
  --base3: #fdf6e3;
  --yellow: #b58900;
  --orange: #cb4b16;
  --red: #dc322f;
  --magenta: #d33682;
  --violet: #6c71c4;
  --blue: #268bd2;
  --cyan: #2aa198;
  --green: #859900;
}

.dark pre[class*=&#x27;language-&#x27;] {
  --base00: #93a1a1;
  --base1: #657b83;
}

  code[class*=&#x27;language-&#x27;],
  pre[class*=&#x27;language-&#x27;] {
    color: var(--base00); /* base00 */
    font-family: Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;
    font-size: 0.95em;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;

    border: none;

    line-height: 1.2;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  pre[class*=&#x27;language-&#x27;]::selection,
  pre[class*=&#x27;language-&#x27;] ::selection,
  code[class*=&#x27;language-&#x27;]::selection,
  code[class*=&#x27;language-&#x27;] ::selection {
    background: #073642; /* base02 */
  }

  /* Code blocks */
  pre[class*=&#x27;language-&#x27;] {
    padding: 1.5em 1em;
    overflow: auto;
    border-radius: 0.3em;
    position: relative;
    background-color: hsl(var(--twc-bg-footer));
    border: 1px solid hsl(var(--twc-border));
  }

  :not(pre) &gt; code[class*=&#x27;language-&#x27;] {
    background-color: #fdf6e3; /* base3 */
  }

  .gatsby-highlight pre[class*=&#x27;language-&#x27;]::after {
    background-color: hsl(var(--twc-main));
    border-radius: 0px 0px 4px 4px;
    color: hsl(var(--twc-bg));
    font-size: 0.75rem;
    font-family: SFMono-Regular, Menlo, Monaco, Consolas, &#x27;Liberation Mono&#x27;, &#x27;Courier New&#x27;,
      monospace;
    letter-spacing: 0.075em;
    line-height: 1;
    padding: 0.25rem 0.5rem;
    position: absolute;
    left: 1.5rem;
    text-align: right;
    top: 0;
  }

  
 .gatsby-highlight pre.language-javascript::after {
    content: &quot;JavaScript&quot;;
    
  }


 .gatsby-highlight pre.language-typescript::after {
    content: &quot;TypeScript&quot;;
    
  }


 .gatsby-highlight pre.language-jsx::after {
    content: &quot;JSX&quot;;
    
  }


 .gatsby-highlight pre.language-tsx::after {
    content: &quot;TSX&quot;;
    
  }


 .gatsby-highlight pre.language-shell::after {
    content: &quot;Shell&quot;;
    background-color: hsl(var(--twc-text-quote))
  }


 .gatsby-highlight pre.language-text::after {
    content: &quot;Text&quot;;
    background-color: hsl(var(--twc-text-quote))
  }


 .gatsby-highlight pre.language-css::after {
    content: &quot;CSS&quot;;
    background-color: hsl(var(--twc-text-quote))
  }


 .gatsby-highlight pre.language-html::after {
    content: &quot;HTML&quot;;
    background-color: hsl(var(--twc-text-quote))
  }


 .gatsby-highlight pre.language-markdown::after {
    content: &quot;Markdown&quot;;
    background-color: hsl(var(--twc-text-quote))
  }


 .gatsby-highlight pre.language-java::after {
    content: &quot;Java&quot;;
    
  }
;

  /* Inline code */
  :not(pre) &gt; code[class*=&#x27;language-&#x27;] {
    padding: 0.1em;
    border-radius: 0.3em;
  }

  .token.comment,
  .token.prolog,
  .token.doctype,
  .token.cdata {
    color: var(--base1); /* base1 */
  }

  .token.punctuation {
    color: #586e75; /* base01 */
  }

  .token.namespace {
    opacity: 0.7;
  }

  .token.property,
  .token.tag,
  .token.boolean,
  .token.number,
  .token.constant,
  .token.symbol,
  .token.deleted {
    color: #268bd2; /* blue */
  }

  .token.selector,
  .token.attr-name,
  .token.string,
  .token.char,
  .token.builtin,
  .token.url,
  .token.inserted {
    color: #2aa198; /* cyan */
  }

  .token.entity {
    color: var(--base00); /* base00 */
    background: #eee8d5; /* base2 */
  }

  .token.atrule,
  .token.attr-value,
  .token.keyword {
    color: #859900; /* green */
  }

  .token.function,
  .token.class-name {
    color: #b58900; /* yellow */
  }

  .token.regex,
  .token.important,
  .token.variable {
    color: #cb4b16; /* orange */
  }

  .token.important,
  .token.bold {
    font-weight: bold;
  }
  .token.italic {
    font-style: italic;
  }

  .token.entity {
    cursor: help;
  }

  pre[class*=&#x27;language-&#x27;].line-numbers {
    position: relative;
    padding-left: 3.5em;
    counter-reset: linenumber;
  }

  pre[class*=&#x27;language-&#x27;].line-numbers &gt; code {
    position: relative;
    white-space: inherit;
  }

  .line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    padding: 1.5em 0 1.5em 1em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  .line-numbers-rows &gt; span {
    display: block;
    counter-increment: linenumber;
  }

  .line-numbers-rows &gt; span:before {
    content: counter(linenumber);
    color: #999;
    display: block;
    padding-right: 0.8em;
    text-align: right;
  }
</style><div class="flex flex-col gap-24 px-24 pb-48 md text-20-400"><h2>개요</h2>
<p>블로그를 단지 글을 쓰는 용도가 아니라, 이전에 정리해둔 정보를 다시 찾아보는 용도로 쓴다면 검색 기능은 필수적이다. 이 글이 올라갈 때는 블로그에 멀쩡히 검색 기능이 붙어 있겠지만 사실 이건 며칠간의 삽질의 결과물이다.</p>
<h4>핵심 개념</h4>
<p>검색에는 세 가지 요소가 필요하다.</p>
<ul>
<li>속도와 성능을 위해 데이터를 검색에 알맞은 형태로 바꿔놓은 <b>인덱스(index)</b></li>
<li>인덱스와 검색어를 이용해 검색을 수행하고 매칭된 결과를 리턴하는 <b>검색 엔진(search engine)</b></li>
<li>사용자로 하여금 검색 기능을 사용할 수 있게 해주는 <b>검색 UI(search UI)</b></li>
</ul>
<p>일반적으로 검색 엔진 라이브러리라고 하면 raw data로부터 인덱스를 생성하고, 인덱스와 검색어를 통해 검색을 수행하는 것까지를 전부 담당한다.</p>
<p><a href="https://www.gatsbyjs.com/docs/how-to/adding-common-features/adding-search/">공식 문서</a>에 따르면, Gatsby 사이트에 검색 기능을 추가하는 방법으로는 <code>js-search</code> 라이브러리나 <code>gatsby-plugin-local-search</code>과 같은 플러그인을 이용해 client-side 검색을 추가하는 방법이 있고, 혹은 Algolia나 ElasticSearch와 같은 API 기반의 외부 검색 엔진을 사용하는 방법이 있다.</p>
<p>전자의 경우 모든 검색 처리를 브라우저에서 수행하므로 사이트 규모가 커질수록 방문자가 다운로드해야 할 인덱스의 크기가 커지는 단점이 있다. 반면 검색 엔진 API의 경우 이러한 단점을 해소할 수 있지만 일반적으로 무료 플랜은 호스팅이나 월별 요청 수에 제한이 있고, 온전한 기능을 사용하려면 유료 플랜을 사용해야 한다.</p>
<h2>진행과정</h2>
<p>자료의 수가 적은 나로서는 검색 엔진 API의 이점이 적어 client-side 검색을 택했다. 그래서 <code>gatsby-plugin-local-search</code> 플러그인을 사용하고, <code>react-use-flexsearch</code> 라이브러리를 이용해 검색결과를 표시하려 했다.</p>
<p>결론부터 말하자면 플러그인이나 라이브러리를 통한 검색 기능 구현은 잘 되지 않았다. 결국 다소 비효율적인 방법으로나마 직접 client-side 검색 기능을 구현하게 되었다. 아래는 그동안 겪은 이슈를 나열한 것이다.</p>
<h4><code>gatsby-plugin-local-search</code> 플러그인 이슈</h4>
<blockquote>
<ul>
<li><code>gatsby-plugin-local-search</code>란 그 이름대로 local search, 즉 client-side 검색 기능을 위한 플러그인이다.</li>
<li><code>gatsby-config.js</code>를 통해 검색에 사용할 쿼리, 필드, 검색 결과로 받을 값 등을 설정할 수 있고, 검색 엔진으로는 FlexSearch와 Lunr 중 하나를 선택해서 사용할 수 있다. 공식 문서에서는 성능이 뛰어난 FlexSearch를 추천하고 있다.</li>
</ul>
</blockquote>
<ul>
<li>이슈라고 하기엔 뭣하지만 FlexSearch의 최신버전은 0.7.21인데 반해 이 플러그인에선 0.6.32버전을 쓴다. 0.6 -> 0.7로 넘어가면서 바뀐 부분이 제법 많으므로 공식문서를 참고할 때 버전을 잘 확인해야 한다.</li>
</ul>
<h4><code>react-use-flexsearch</code> 라이브러리 이슈</h4>
<blockquote>
<ul>
<li><code>react-use-flexsearch</code>란 FlexSearch로 생성한 인덱스와 스토어를 사용해 검색을 수행할 수 있는 hook을 제공하는 라이브러리다.</li>
<li>FlexSearch는 구버전인 0.6.22를 사용한다. 오랫동안 업데이트되지 않은 라이브러리라 비슷한 기능이라면 직접 구현하는 편이 낫지 않을까 싶다.</li>
</ul>
</blockquote>
<ul>
<li>
<p>타입 정의가 되어 있지 않다. TypeScript에서 사용하려면 별도의 타입 정의 파일을 추가해줘야 한다.</p>
</li>
<li>
<p>인덱스 생성 시 옵션값을 넘길 방법이 없다. FlexSearch는 인덱스 객체를 생성할 때 옵션을 통해 인코더나 토큰화 함수를 설정할 수 있고, 특히 인코더는 인덱스 추가 뿐만 아니라 검색어에도 적용된다. 하지만 옵션을 받지 않으므로 인덱스 객체는 Built-in 함수를 사용하게 되고, 결국 후술할 문제로 인해 이 라이브러리를 사용하면 원천적으로 한글 검색이 되지 않는다.</p>
<p><img src=".%5Creact-use-flexsearch-1.png" alt="react-use-flexsearch-1"></p>
</li>
<li>
<p><code>Index.search(query, searchOptions)</code>라는, 존재하지 않는 사용법으로 메서드를  사용하고 있다. 공식문서에 명시된 사용법은 <code>Index.search(string, &#x3C;limit>, &#x3C;callback>)</code>와 <code>Index.search(&#x3C;options>)</code> 뿐이다.</p>
<p><img src=".%5Creact-use-flexsearch-2.png" alt="react-use-flexsearch-2"></p>
</li>
</ul>
<h4>FlexSearch 라이브러리 이슈</h4>
<blockquote>
<ul>
<li>FlexSearch란 텍스트 검색 라이브러리다.</li>
<li>처음에 인덱스를 생성하고, &#x3C;키, 텍스트> 쌍으로 검색 대상이 될 데이터를 넣고, 인덱스에 추가한 데이터에 대해 검색을 수행할 수 있다. 인덱스 생성 시에 문자열 인코딩이나 토큰화 함수를 포함한 다양한 옵션을 줄 수 있다.</li>
</ul>
</blockquote>
<ul>
<li>
<p>Index Option의 <code>encode</code>는 공식문서의 설명과 달리 <code>string</code> 타입의 인코더 명(<code>"simple"</code>, <code>"balance"</code> 등)을 받으면 오류가 난다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// flexsearch/src/index.js를 보면 이런 식으로 this.encode를 초기화하고</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>encode <span class="token operator">=</span> options<span class="token punctuation">[</span><span class="token string">"encode"</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span>charset <span class="token operator">&amp;&amp;</span> charset<span class="token punctuation">.</span>encode<span class="token punctuation">)</span> <span class="token operator">||</span> default_encoder<span class="token punctuation">;</span>

<span class="token comment">// (문자열이면 built-in 함수로 교체하는 일 없이) 바로 이런 식으로 사용한다</span>
content <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>따라서 특정한 build-in 인코더를 사용하고 싶다면 옵션 중 <code>charset</code>을 <code>"latin:(인코더명)"</code>과 같은 형태로 지정해야 한다.</p>
</li>
<li>
<p><code>encode</code> 옵션을 주지 않았을 경우 built-in 인코더를 사용하는데, 알파벳과 숫자를 제외한 모든 문자를 제거하는 과정이 인코딩 과정에 포함되어 있다. 이 때문에 별도의 함수를 <code>encode</code> 옵션에 넣어주지 않으면 한글은 인덱스에 추가되지도 않고 검색도 되지 않는다.</p>
</li>
<li>
<p>공식문서에서 소개하는 중국어, 일본어, 한국어용 인코딩 설정은 다음과 같다.</p>
<p><img src=".%5Cflexsearch.png" alt="flexsearch"></p>
<p>하지만 이는 어디까지나 예시일 뿐이고 실제로 이 설정을 넣으면 검색이 제대로 되지 않는다.</p>
<ul>
<li><code>.replace(/[\x00-\x7F]/g, '')</code>: ASCII 문자를 제거 -> 영어나 숫자 검색이 불가능해진다.</li>
<li><code>.split('')</code>: 한 글자씩 쪼갬 -> 검색 정확도가 크게 떨어진다. <code>encode</code> 함수는 검색어에도 적용이 되기 때문에 한 글자씩 쪼갠 인덱스를 한 글자씩 쪼갠 검색어로 검색을 하게 된다. 예를 들어 "<strong>포트</strong>"라고 검색을 하면 "<strong>포트</strong>", "<strong>포</strong>스<strong>트</strong>", "<strong>포</strong>인<strong>트</strong>" 등이 전부 검색된다.</li>
</ul>
<p>따라서 적절한 한국어 검색을 위해선 별도의 인코더, 토큰화 함수를 마련해야 한다.</p>
</li>
</ul>
<p>결론적으로 FlexSearch를 사용하기 위해서는 한국어용 <code>encode</code>, <code>tokenize</code> 옵션이 필수적인데, 아무래도 직접 구현할 만한 게 아니라서 FlexSearch 사용은 포기해야 했다. 영어와 한국어라는 언어의 차이 때문에 발생한 문제인 만큼 대부분의 검색 라이브러리는 동일한 문제를 안고 있을 거라 생각했고, 실제로 <code>gatsby-plugin-local-search</code>에서 지원하는 다른 검색엔진 라이브러리인 Lunr도 마찬가지였다.</p>
<h4>검색 기능 직접 구현하기</h4>
<p>결국 raw data로부터 직접 검색하는 기능을 구현하기로 했다. 구상한 검색 과정은 다음과 같다.</p>
<ol>
<li>검색어와 포스트를 인코딩한다. (현재는 <code>toLowerCase</code>만)</li>
<li>모든 포스트에 대해 검색어로 <code>String.match()</code>를 수행하고, 매치된 수가 1 이상인 포스트만 결과 리스트(<code>newResults</code>)에 저장한다.</li>
<li>매치된 갯수를 정확도의 척도로 삼고, 결과 리스트를 정확도의 내림차순으로 정렬하여 사용한다.</li>
</ol>
<p>포스트의 갯수를 n, 포스트 당 평균 글자수를 m이라 하면 한 번 검색할 때마다 O(n * m)의 시간복잡도를 갖는 셈이다. 성능을 조금이라도 개선하기 위해 다음과 같은 최적화 방법을 생각했다.</p>
<ul>
<li>검색어는 기본적으로 길이가 2 이상인 것만 사용한다. 한 글자로는 의미가 잘 전달되지 않고 원하는 결과를 찾기도 힘들기 때문이다.</li>
<li>검색어에 대한 결과값은 세션 스토리지에 캐싱하여 사용한다. 로컬 스토리지가 아니라 세션 스토리지인 이유는, 새로운 포스트가 올라오면 기존의 검색 결과는 의미가 없어지기 때문에 브라우저가 오랫동안 검색 결과를 갖고 있을 필요가 없다고 생각했기 때문이다.</li>
<li>검색 기능을 change 이벤트 핸들러로 사용할 때, 입력 중 검색 기능이 작동하는 것을 방지하기 위해 debounce를 적용한다. throttle이 아닌 이유는 검색은 연속된 이벤트의 도중보다는 연속된 이벤트의 끝이 더 의미가 있기 때문이다.</li>
<li>검색은 비동기적으로 수행하도록 한다.</li>
</ul>
<p>그래서 완성된 코드는 다음과 같다.</p>
<ul>
<li>
<p><code>src/hooks/useSearch.ts</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span>useEffect<span class="token punctuation">,</span> useState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  escapedRegExp<span class="token punctuation">,</span>
  getProperty<span class="token punctuation">,</span>
  getStorageItem<span class="token punctuation">,</span>
  setStorageItem<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/utils/common'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
  searchFrom<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  refBy<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  limit<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  cacheKey<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  debounceWait<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  minKeywordLength<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> useSearch <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span>
  dataList<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    searchFrom<span class="token punctuation">,</span>
    refBy<span class="token punctuation">,</span>
    limit <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span>
    cacheKey <span class="token operator">=</span> <span class="token string">'search'</span><span class="token punctuation">,</span>
    debounceWait <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">,</span>
    minKeywordLength <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token operator">:</span> Options
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>results<span class="token punctuation">,</span> setResults<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>store<span class="token punctuation">,</span> setStore<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">>></span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> storageKey <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">store_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cacheKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cachedStore <span class="token operator">=</span> <span class="token function">getStorageItem</span><span class="token punctuation">(</span>storageKey<span class="token punctuation">,</span> sessionStorage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedStore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setStore</span><span class="token punctuation">(</span>cachedStore<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> store<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    dataList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> refKey <span class="token operator">=</span> <span class="token function">getProperty</span><span class="token punctuation">(</span>refBy<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      store<span class="token punctuation">[</span>refKey<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">setStorageItem</span><span class="token punctuation">(</span>storageKey<span class="token punctuation">,</span> store<span class="token punctuation">,</span> sessionStorage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setStore</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dataList<span class="token punctuation">,</span> refBy<span class="token punctuation">,</span> cacheKey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">encode</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">search</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>query<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    query <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> storageKey <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">query_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cacheKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cachedResults <span class="token operator">=</span> <span class="token generic-function"><span class="token function">getStorageItem</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>storageKey<span class="token punctuation">,</span> sessionStorage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedResults<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setResults</span><span class="token punctuation">(</span>cachedResults<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=></span> store<span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> hitCount<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> newResults<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    dataList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> minKeywordLength<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> searchString <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token function">getProperty</span><span class="token punctuation">(</span>searchFrom<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> refKey <span class="token operator">=</span> <span class="token function">getProperty</span><span class="token punctuation">(</span>refBy<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token function">escapedRegExp</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hitCount<span class="token punctuation">[</span>refKey<span class="token punctuation">]</span><span class="token punctuation">)</span> hitCount<span class="token punctuation">[</span>refKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> hit <span class="token operator">=</span> searchString<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>re<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>hit<span class="token punctuation">)</span> hitCount<span class="token punctuation">[</span>refKey<span class="token punctuation">]</span> <span class="token operator">+=</span> hit<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>hitCount<span class="token punctuation">[</span>refKey<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> newResults<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>refKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    newResults <span class="token operator">=</span> newResults
      <span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> hitCount<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">-</span> hitCount<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> limit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setStorageItem</span><span class="token punctuation">(</span>storageKey<span class="token punctuation">,</span> newResults<span class="token punctuation">,</span> sessionStorage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setResults</span><span class="token punctuation">(</span>newResults<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=></span> store<span class="token punctuation">[</span>result<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> handleSearchInputChange <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">debounce</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>e<span class="token operator">:</span> React<span class="token punctuation">.</span>ChangeEvent<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">search</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span>
    debounceWait
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>search<span class="token punctuation">,</span> results<span class="token punctuation">,</span> handleSearchInputChange<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useSearch<span class="token punctuation">;</span></code></pre></div>
</li>
<li>
<p><code>src/utils/common.ts</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token operator">...</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getStorageItem <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">(</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  storage <span class="token operator">=</span> localStorage
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setStorageItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  storage <span class="token operator">=</span> localStorage
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  storage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> getProperty <span class="token operator">=</span> <span class="token punctuation">(</span>
  query<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  obj<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  separator <span class="token operator">=</span> <span class="token string">'.'</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> query <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> query <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>separator<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> nextKey <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>nextKey <span class="token operator">||</span> <span class="token operator">!</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">getProperty</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>nextKey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">escapedRegExp</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> flags<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">escapeRegExp</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
</li>
<li>
<p><code>src/views/searchModal/index.tsx</code></p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>graphql<span class="token punctuation">,</span> useStaticQuery<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'gatsby'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useSearch <span class="token keyword">from</span> <span class="token string">'src/hooks/useSearch'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>MdxNode<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/types'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>getPostUrl<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/utils/common'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  {
    allMdx(sort: {fields: frontmatter___date, order: DESC}) {
      nodes {
        slug
        frontmatter {
          title
          tags
        }
        rawBody
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">SearchModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    allMdx<span class="token operator">:</span> <span class="token punctuation">{</span>nodes<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useStaticQuery</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span>allMdx<span class="token operator">:</span> <span class="token punctuation">{</span>nodes<span class="token operator">:</span> MdxNode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>pageQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>results<span class="token punctuation">,</span> handleSearchInputChange<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useSearch</span><span class="token punctuation">(</span>
    nodes<span class="token punctuation">,</span>
    <span class="token string">'rawBody'</span><span class="token punctuation">,</span>
    <span class="token string">'slug'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      cacheKey<span class="token operator">:</span> <span class="token string">'search-modal'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token string">'500px'</span><span class="token punctuation">,</span>
        position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
        top<span class="token operator">:</span> <span class="token string">'20%'</span><span class="token punctuation">,</span>
        left<span class="token operator">:</span> <span class="token string">'50%'</span><span class="token punctuation">,</span>
        backgroundColor<span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
        border<span class="token operator">:</span> <span class="token string">'1px solid black'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSearchInputChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>results<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>result<span class="token punctuation">.</span>slug<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">getPostUrl</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>slug<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>result<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>tags<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>result<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> SearchModal<span class="token punctuation">;</span></code></pre></div>
</li>
<li>
<p>결과</p>
</li>
</ul>
<p><img src="https://lh3.googleusercontent.com/pw/AM-JKLWjFgS7lvr_INbby6lcBxZWssKwCWPkQoM5P6UK4dEwWgYENiYmA3qeW1vhyms8iceTTiV2phHo1bXezOSmfR4EmFAV877iftbymi_1uDOcPJxeGHt1CoUezTXqjv1iNl2o7f0j3ywrkaO36UVwP1Fw=w480-h356-no?authuser=0" alt="Search"></p>
<ul>
<li>세션 스토리지</li>
</ul>
<p><img src=".%5Csession-storage.png" alt="session storage"></p>
<p>이로써 검색 기능이 구현되었고 세션 스토리지에 검색 데이터도 잘 저장되는 것을 확인할 수 있다.</p>
<h2>후기</h2>
<p>처음에 플러그인과 라이브러리를 사용하며 '이게 왜 안 되지' 싶은 것들을 하나하나 찾다 보니 생각보다 시간이 많이 걸렸다. 그래도 라이브러리 코드를 뒤져가며 원인을 하나씩 살펴보는 건 나름대로 즐거운 경험이었다. FlexSearch에서 찾은 이슈는 추후에 PR을 넣을 예정인데 받아들여질지 어떨지는 잘 모르겠다.</p>
<p>여하튼 이것으로 블로그로서 갖추어야 할 기본적인 기능들은 모두 갖춘 셈이다. 나머지 필요한 기능들은 디자인 적용 후에 하나씩 추가해나갈 예정이다.</p></div></article></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022/02-18-gatsby-blog-search/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-ac65e676c45669f8e307.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-00ecc633fb4d510e23b2.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-8101b3c81ebf79932c28.js\"],\"component---src-pages-blog-tsx\":[\"/component---src-pages-blog-tsx-17904792d719efa64bb6.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-f24288b723b3879e27a6.js\"],\"component---src-pages-tags-tsx\":[\"/component---src-pages-tags-tsx-abdda339c3073a584ac7.js\"],\"component---src-templates-{post}-tsx-content-file-path-null\":[\"/component---src-templates-{post}-tsx-content-file-path-null-3e6f1d284d541a5e8c2a.js\"],\"component---src-templates-{tag}-tsx\":[\"/component---src-templates-{tag}-tsx-24bee62c6b108511ce0e.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="1cdcaa7f72578a3db44c";</script><script src="/webpack-runtime-21a98688ce451a527aed.js" async></script><script src="/framework-9260c5fc4673863b98e8.js" async></script><script src="/app-ac65e676c45669f8e307.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>